(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58fe3eb4"],{"0481":function(e,r,s){"use strict";var t=s("23e7"),o=s("a2bf"),a=s("7b0b"),n=s("50c4"),i=s("a691"),l=s("65f0");t({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,r=a(this),s=n(r.length),t=l(r,0);return t.length=o(t,r,r,s,0,void 0===e?1:i(e)),t}})},"07ac":function(e,r,s){var t=s("23e7"),o=s("6f53").values;t({target:"Object",stat:!0},{values:function(e){return o(e)}})},"1a89":function(e,r,s){"use strict";s("64d2")},4069:function(e,r,s){var t=s("44d2");t("flat")},"5f4e":function(e,r,s){"use strict";s("eaaa")},"64d2":function(e,r,s){},"6f53":function(e,r,s){var t=s("83ab"),o=s("df75"),a=s("fc6a"),n=s("d1e7").f,i=function(e){return function(r){var s,i=a(r),l=o(i),c=l.length,p=0,u=[];while(c>p)s=l[p++],t&&!n.call(i,s)||u.push(e?[s,i[s]]:i[s]);return u}};e.exports={entries:i(!0),values:i(!1)}},"9ed6":function(e,r,s){"use strict";s.r(r);var t=function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("div",{staticClass:"login-container"},[s("div",{staticClass:"form-toggle"},[s("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.toggleForm("login")}}},[e._v("登陆")]),s("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.toggleForm("register")}}},[e._v("注册")])],1),"login"===e.currentForm?s("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,"auto-complete":"on","label-position":"left"}},[s("div",{staticClass:"title-container"},[s("h3",{staticClass:"title"},[e._v("登 录")])]),s("el-form-item",{attrs:{prop:"username"}},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"user"}})],1),s("el-input",{ref:"username",attrs:{placeholder:"Username",name:"username",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.username,callback:function(r){e.$set(e.loginForm,"username",r)},expression:"loginForm.username"}})],1),s("el-form-item",{attrs:{prop:"password"}},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"password"}})],1),s("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"Password",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.handleLogin(r)}},model:{value:e.loginForm.password,callback:function(r){e.$set(e.loginForm,"password",r)},expression:"loginForm.password"}}),s("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[s("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1),s("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(r){return r.preventDefault(),e.handleLogin(r)}}},[e._v("登陆")])],1):s("el-form",{ref:"registerForm",staticClass:"register-form",attrs:{model:e.registerForm,rules:e.registerRules,"auto-complete":"on","label-position":"left"}},[s("div",{staticClass:"title-container"},[s("h3",{staticClass:"title"},[e._v("注 册")])]),s("el-form-item",{attrs:{prop:"username"}},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"user"}})],1),s("el-input",{ref:"username",attrs:{placeholder:"Username",name:"username",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.registerForm.username,callback:function(r){e.$set(e.registerForm,"username",r)},expression:"registerForm.username"}})],1),s("el-form-item",{attrs:{prop:"password"}},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"password"}})],1),s("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"Password",name:"password",tabindex:"2","auto-complete":"on"},model:{value:e.registerForm.password,callback:function(r){e.$set(e.registerForm,"password",r)},expression:"registerForm.password"}}),s("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[s("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1),s("el-form-item",{attrs:{prop:"password2"}},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"password"}})],1),s("el-input",{key:e.passwordType,ref:"password2",attrs:{type:e.passwordType,placeholder:"Confirm Password",name:"password2",tabindex:"3","auto-complete":"on"},model:{value:e.registerForm.password2,callback:function(r){e.$set(e.registerForm,"password2",r)},expression:"registerForm.password2"}})],1),s("el-form-item",{attrs:{prop:"email"}},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"email"}})],1),s("el-input",{ref:"email",attrs:{placeholder:"Email",name:"email",type:"email",tabindex:"4","auto-complete":"on"},model:{value:e.registerForm.email,callback:function(r){e.$set(e.registerForm,"email",r)},expression:"registerForm.email"}})],1),s("el-form-item",{attrs:{prop:"role"}},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"role"}})],1),s("el-select",{attrs:{placeholder:"Select Role",name:"role",tabindex:"5","auto-complete":"on"},model:{value:e.registerForm.role,callback:function(r){e.$set(e.registerForm,"role",r)},expression:"registerForm.role"}},[s("el-option",{attrs:{label:"Admin",value:"admin"}}),s("el-option",{attrs:{label:"Teacher",value:"teacher"}}),s("el-option",{attrs:{label:"Student",value:"student"}}),s("el-option",{attrs:{label:"Reader",value:"reader"}})],1)],1),s("el-form-item",{attrs:{prop:"phone"}},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"phone"}})],1),s("el-input",{ref:"phone",attrs:{placeholder:"Phone Number",name:"phone",type:"text",tabindex:"6","auto-complete":"on"},model:{value:e.registerForm.phone,callback:function(r){e.$set(e.registerForm,"phone",r)},expression:"registerForm.phone"}})],1),s("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(r){return r.preventDefault(),e.handleRegister(r)}}},[e._v("注册")])],1)],1)},o=[],a=(s("0481"),s("a15b"),s("4069"),s("07ac"),s("c24f")),n=s("5f87"),i={name:"Auth",data:function(){var e=function(e,r,s){s()},r=function(e,r,s){r.length<6?s(new Error("The password can not be less than 6 digits")):s()};return{currentForm:"login",loginForm:{username:"",password:""},loginRules:{username:[{required:!0,trigger:"blur",validator:e}],password:[{required:!0,trigger:"blur",validator:r}]},registerForm:{username:"",password:"",password2:"",email:"",role:"",phone:""},registerRules:{username:[{required:!0,trigger:"blur",validator:e}],password:[{required:!0,trigger:"blur",validator:r}],password2:[{required:!0,trigger:"blur",message:"Please confirm your password"}],email:[{required:!0,trigger:"blur",type:"email",message:"Please enter a valid email"}],role:[{required:!0,trigger:"blur",message:"Please enter a role"}],phone:[{required:!0,trigger:"blur",message:"Please enter a phone number"}]},loading:!1,passwordType:"password",redirect:void 0}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0}},methods:{toggleForm:function(e){this.currentForm=e},showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},handleLogin:function(){var e=this;console.log("Attempting to log in"),this.$refs.loginForm.validate((function(r){if(!r)return console.log("Form validation error"),!1;console.log("Form is valid"),e.loading=!0,console.log(e.loginForm),Object(a["e"])(e.loginForm).then((function(r){var s=r.data;console.log("Response data: ",s),s.access?(console.log("Access Token: ",s.access),console.log("User Info: ",s.user),Object(n["c"])(s.access),e.$store.dispatch("user/login",{token:s.access,user:s.user}),console.log("Navigation to main page"),e.$router.push({path:e.redirect||"/"}),e.loading=!1):(e.loading=!1,e.$message.error("Login failed, please try again."))})).catch((function(r){e.loading=!1,console.log("Error occurred during login:",r),e.$message.error("Login failed, please try again. Error: "+r.message)}))}))},handleRegister:function(){var e=this;this.$refs.registerForm.validate((function(r){if(!r)return console.log("error submit!!"),!1;e.loading=!0,Object(a["g"])(e.registerForm).then((function(r){console.log("Register response:",r),console.log("Register response status:",r.status),201===r.status&&(e.$message.success("注册成功!"),e.loading=!1,console.log("准备跳转到登录页面"),e.$refs.registerForm.resetFields(),e.$router.push({path:"/login"}))})).catch((function(r){if(e.loading=!1,r.response&&r.response.data){var s=Object.values(r.response.data).flat();e.$message.error(s.join(" "))}else e.$message.error("注册失败，请重试. Error: "+r.message)}))}))}}},l=i,c=(s("1a89"),s("5f4e"),s("2877")),p=Object(c["a"])(l,t,o,!1,null,"143eb5fe",null);r["default"]=p.exports},a15b:function(e,r,s){"use strict";var t=s("23e7"),o=s("44ad"),a=s("fc6a"),n=s("a640"),i=[].join,l=o!=Object,c=n("join",",");t({target:"Array",proto:!0,forced:l||!c},{join:function(e){return i.call(a(this),void 0===e?",":e)}})},a2bf:function(e,r,s){"use strict";var t=s("e8b5"),o=s("50c4"),a=s("0366"),n=function(e,r,s,i,l,c,p,u){var d,g=l,m=0,f=!!p&&a(p,u,3);while(m<i){if(m in s){if(d=f?f(s[m],m,r):s[m],c>0&&t(d))g=n(e,r,d,o(d.length),g,c-1)-1;else{if(g>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[g]=d}g++}m++}return g};e.exports=n},eaaa:function(e,r,s){}}]);